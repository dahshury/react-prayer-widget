# FSD Violations (scanned set)

- `app/api-routes/wtimes.ts` (lines 3-10): Imports reach into `entities/prayer/api` and `entities/prayer/lib/*`, bypassing the slice public API. **Fix:** Re-export `PrayerTimesRequestBody`, `parseTimesFromFileContent`, `findWtimesFile`, `isInDST`, `shift`, and `shift1h` from `entities/prayer/index.ts`, then change this file’s imports to pull from `@/entities/prayer`.
- `app/demo/page.tsx` (line 2): Imports `DemoPage` from an internal path `@/src/pages/_demo`, skipping the pages slice public API and adding an extra `src` segment. **Fix:** Expose the page via the pages layer public API (e.g., `src/pages/demo/index.ts`), then make this route file re-export via `export { DemoPage as default } from "@/pages/demo"` (add metadata re-export if needed). If a suspense wrapper is required, keep it inside the pages slice instead of the app layer.
- `app/page.tsx` (line 1): Imports `PrayerTimesPage` from `@/src/pages/prayer-times`, skipping the pages slice public API and using an extra `src` segment. **Fix:** Expose the page through the pages public API (e.g., `src/pages/prayer-times/index.ts`), then re-export here via `export { PrayerTimesPage as default } from "@/pages/prayer-times"` (add metadata re-export if required). Keep any wrappers (e.g., suspense) inside the page slice.
- `entities/prayer/api/prayer.service.ts` (line 1): Imports its own slice via `@/entities/prayer`, which goes through the public API and risks circular deps. **Fix:** Import types via relative paths inside the slice (e.g., `import type { Location, PrayerSettings, PrayerTimes } from "../model"`).
- `entities/prayer/api/prayer.service.ts` (lines 24-50): Hardcodes `/api/wtimes` (app-layer route) inside an entity, violating the rule that entities must stay URL-agnostic. **Fix:** Move the route to `shared/routes` (or accept it as a prop/config) and have upper layers supply the URL; this service should accept a `wtimesUrl` argument or be composed at a higher layer.
- `entities/prayer/config/constants.ts` (line 1): Imports `PrayerSettings` from the slice public API `@/entities/prayer` instead of using a local relative import, which creates unnecessary coupling and potential cycles. **Fix:** Change to a relative import, e.g., `import type { PrayerSettings } from "../model"`.
- `entities/prayer/lib/find-wtimes-file.ts` (line 3): Cross-entity import `normalizeCity` from `@/entities/location`, bypassing the required `@x` surface for cross-entity use. **Fix:** Expose the needed helper via `entities/location/@x/prayer.ts` (or similar minimal @x surface) and import from that @x path instead of the public entity entry.
- `entities/index.ts` (lines 2-3): Uses wildcard re-exports (`export * from "./location"; export * from "./prayer";`), which are forbidden for public APIs. **Fix:** Replace with named exports only (e.g., `export { LocationService, normalizeCity, parseCities } from "./location";` and explicit prayer exports), or remove this aggregator if not required by FSD rules.
- `features/navigation/ui/top-bar.tsx` (line 6): Imports `DualDateDisplay` from `@/widgets/dates`, which is upward from features to widgets (violates layer import rule). **Fix:** Move this display into the features slice (or shared/ui) and import locally, or have the page/widget inject the component via props.
- `features/prayer/ui/prayer-page-header.tsx` (line 8): Imports `DualDateDisplay` from `@/widgets/dates` (features → widgets). **Fix:** Pull the UI primitive into the feature (or shared/ui) or pass it in from an upper layer.
- `features/prayer/ui/next-prayer-section.tsx` (lines 6-7): Imports `WidgetPrayerCard` and `MinimalTicker` from widgets, which is an upward dependency from features. **Fix:** Move the required UI into the feature (or shared/ui) and depend downward, or have the page/widget compose these widgets and pass necessary props.
- `features/prayer/ui/prayer-cards-grid.tsx` (line 6): Imports `WidgetPrayerCard` from widgets (features → widgets). **Fix:** Same as above—localize or inject the widget instead of importing upward.
- `features/prayer/ui/ticker-section.tsx` (line 5): Imports `MinimalTicker` from widgets (features → widgets). **Fix:** Localize the ticker UI within the feature or accept it via props from a higher layer.
